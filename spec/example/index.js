!function(){return function e(n,t,r){function i(u,c){if(!t[u]){if(!n[u]){var a="function"==typeof require&&require;if(!c&&a)return a(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var p=t[u]={exports:{}};n[u][0].call(p.exports,function(e){return i(n[u][1][e]||e)},p,p.exports,e,n,t,r)}return t[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}}()({1:[function(e,n,t){var r,i,o=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{i="function"==typeof clearTimeout?clearTimeout:c}catch(e){i=c}}();var s,p=[],f=!1,y=-1;function l(){f&&s&&(f=!1,s.length?p=s.concat(p):y=-1,p.length&&h())}function h(){if(!f){var e=a(l);f=!0;for(var n=p.length;n;){for(s=p,p=[];++y<n;)s&&s[y].run();y=-1,n=p.length}s=null,f=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===c||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(n){try{return i.call(null,e)}catch(n){return i.call(this,e)}}}(e)}}function g(e,n){this.fun=e,this.array=n}function d(){}o.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];p.push(new g(e,n)),1!==p.length||f||a(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],2:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new Terminal({cursorBlink:!0,rows:24,scrollback:48,tabStopWidth:2});r.open(document.querySelector("#terminal"));var i=JSON.stringify.bind(JSON);t.default=function(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];r.writeln([e].concat(n.map(i)).join(" "))}}},{}],3:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e(4),i=e("resolve-call").default(),o=i(e(2).default("example:")),u=i(function(e){return{cipher:e,auth:e}}),c=r.default({openpgp:openpgp});o("import key...");var a=c.getKeysFromArmor("-----BEGIN PGP PRIVATE KEY BLOCK-----\nVersion: GnuPG v1\n\n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\nmN7gO16/RLWq8LQMYpsJ\n=Rm/S\n-----END PGP PRIVATE KEY BLOCK-----\n"),s=u(c.unlock(a,"passphrase to decrypt private key")),p=c.encrypt(s,"rob says wow!");o(p),o(c.decrypt(s,p))},{2:2,4:4,undefined:void 0}],4:[function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=e(5),o=e(6),u=e(7),c=e("csrkey-cache"),a=e("bluebird"),s=e("resolve-call").default({Promise:a}),p={size:4096,unlocked:!1},f=function(){function n(e,n,t,r){this.cache=e,this.getLiveKey=n,this.getProxyKey=t,this.openpgp=r}return n.prototype.configure=function(e){var n=g(this.openpgp,e);return a.resolve(r({},n.config))},n.prototype.isValidKeyHandle=function(e){var n=this;return a.try(function(){return n._getCachedLiveKey(e)}).catch(function(){return!1}).then(Boolean)},n.prototype.generateKey=function(e,n){var t=this;return m(e)?function(e){return!e||(!e.passphrase||u.isString(e.passphrase))&&(!e.size||u.isNumber(e.size))&&(!e.unlocked||u.isBoolean(e.unlocked))}(n)?a.try(function(){return t.openpgp.key.generate(function(e,n){var t=r({user:[].concat(e)},p,n),i={userIds:t.user,numBits:t.size,unlocked:t.unlocked};return t.passphrase&&(i.passphrase=t.passphrase),i}(e,n))}).then(function(e){return t.getLiveKey(e)}).then(function(e){return t.cacheAndProxyKey(e)}):y("invalid key options"):y("invalid user")},n.prototype.getPublicKey=function(e){var n=this;return a.try(function(){return n._getCachedLiveKey(e)}).then(function(t){return t.bp.isPublic?n.getProxyKey(l(e),t.bp):t.toPublicKey().then(function(e){return n.cacheAndProxyKey(e)})})},n.prototype.getKeysFromArmor=function(e,n){var t=this;return u.isString(e)?a.try(function(){var n=t.openpgp.key.readArmored(e).keys.map(function(e){return t.getLiveKey(e).then(function(e){return t.cacheAndProxyKey(e)})});return a.all(n).then(function(e){return e.length>1?e:e[0]})}):y("invalid armor: not a string")},n.prototype.getArmorFromKey=function(e){var n=this;return a.try(function(){return n._getCachedLiveKey(e).armor()})},n.prototype.unlock=function(e,n,t){var r=this;return u.isString(n)?a.try(function(){return r._getCachedLiveKey(e).unlock(n)}).then(function(e){return r.cacheAndProxyKey(e)}):y("invalid passphrase: not a string")},n.prototype.lock=function(e,n,t){var r=this;return u.isString(n)?a.try(function(){var t=r._getCachedLiveKey(e);if(t.bp.isLocked)return y("key not unlocked");var i=l(e);return r.cache.del(i),t.lock(n)}).then(function(e){return r.cacheAndProxyKey(e)}):y("invalid passphrase: not a string")},n.prototype.encrypt=function(e,n,t){var r=this;return u.isString(n)?a.try(function(){return r.openpgp.encrypt({privateKeys:r.getCachedPrivateOpenpgpKeys(e.auth),publicKeys:r.getCachedOpenpgpKeys(e.cipher),data:n})}).get("data"):y("invalid plain text: not a string")},n.prototype.decrypt=function(e,n,t){var r=this;return u.isString(n)?a.try(function(){return r.openpgp.decrypt({privateKeys:r.getCachedPrivateOpenpgpKeys(e.cipher)[0],publicKeys:r.getCachedOpenpgpKeys(e.auth),message:r.openpgp.message.readArmored(n)})}).get("data"):y("invalid cipher: not a string")},n.prototype.sign=function(e,n,t){var r=this;return a.try(function(){var t=r.getCachedOpenpgpKeys(e);return u.isString(n)?r.openpgp.message.fromText(n).sign(t).then(function(e){return e.armor()}):y("invalid text: not a string")})},n.prototype.verify=function(e,n,t){var r=this;return a.try(function(){var t=r.getCachedOpenpgpKeys(e);if(!u.isString(n))return y("invalid armor: not a string");var i=r.openpgp.message.readArmored(n);return i.verify(t).then(function(e){var n=e.filter(function(e){return!e.valid}).map(function(e){return e.keyid}).join();return n?y("authentication failed: "+n):i.getText()})})},n.prototype._getCachedLiveKey=function(e){var n=l(e),t=n&&this.cache.get(n);if(!t)throw new Error("invalid key reference: not a string or stale");return t},n.prototype.getCachedLiveKeys=function(e){var n=this,t=[].concat(e);if(!t.length)throw new Error("no key references");return t.map(function(e){return n._getCachedLiveKey(e)})},n.prototype.getCachedOpenpgpKeys=function(e){return this.getCachedLiveKeys(e).map(function(e){return e.key})},n.prototype.getCachedPrivateOpenpgpKeys=function(e){var n=this.getCachedLiveKeys(e);if(n.some(function(e){return e.bp.isLocked}))throw new Error("private key not unlocked");return n.map(function(e){return e.key})},n.prototype.cacheAndProxyKey=function(e){var n=this.cache.set(e);if(!n)throw new Error("fail to cache key");return this.getProxyKey(n,e.bp)},n.getInstance=function(t){var a=r({},t),p=a.cache||c.default(),f=function(n){return function(e){return!!e&&["config","crypto","key","message"].every(function(n){return!!e[n]})&&[e.encrypt,e.decrypt,e.crypto.hash&&e.crypto.hash.sha256,e.key.readArmored,e.key.generate,e.message.fromText,e.message.readArmored].every(function(e){return u.isFunction(e)})}(n)?n:g(e("openpgp"),h,n)}(a.openpgp),y=new n(p,a.getLiveKey||i.default({openpgp:f}),a.getProxyKey||o.default,f);return n.PUBLIC_METHODS.reduce(function(e,n){return e[n]=s(y[n]).bind(y),e},{})},n.PUBLIC_METHODS=["configure","isValidKeyHandle","generateKey","getPublicKey","getKeysFromArmor","getArmorFromKey","unlock","lock","encrypt","decrypt","sign","verify"],n}();function y(e){return a.reject(new Error(e))}function l(e){var n=u.isString(e)?e:!!e&&e.handle;return u.isString(n)&&n}var h={aead_protect:!0,aead_protect_version:0};function g(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r=[e.config].concat(n.map(v));return Object.assign.apply(Object,r),e}var d={prefer_hash_algorithm:u.isNumber,encryption_cipher:u.isNumber,compression:u.isNumber,aead_protect:u.isBoolean,integrity_protect:u.isBoolean,ignore_mdc_error:u.isBoolean,rsa_blinding:u.isBoolean,use_native:u.isBoolean,zero_copy:u.isBoolean,debug:u.isBoolean,show_version:u.isBoolean,show_comment:u.isBoolean,versionstring:u.isString,commentstring:u.isString,keyserver:u.isString,node_store:u.isString};function v(e){return Object.keys(e||{}).reduce(function(n,t){var r=d[t];if(!r)return n;var i=e[t];return r(i)?(n[t]=i,n):n},{})}function m(e){return Array.isArray(e)?e.every(m):u.isString(e)||!!e&&u.isString(e.email)&&(!name||u.isString(e.name))}var k=f.getInstance;t.default=k},{5:5,6:6,7:7,undefined:void 0}],7:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isString=function(e){return"string"==typeof(e&&e.valueOf())},t.isNumber=function(e){return"number"==typeof(e&&e.valueOf())},t.isBoolean=function(e){return"boolean"==typeof(e&&e.valueOf())},t.isFunction=function(e){return"function"==typeof e}},{}],6:[function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,n){var t=r({handle:e},n);return t.keys=n.keys.map(function(e){return r({},e)}),t.user={ids:n.user.ids.slice()},t}},{}],5:[function(e,n,t){(function(n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=e("base64-js"),o=e("bluebird"),u=function(){function e(e,n,t){this.utils=e,this.key=n,this.bp=t}return e.prototype.armor=function(){var e=this;return o.try(function(){return e.key.armor()})},e.prototype.toPublicKey=function(){var n=this;return this.bp.isPublic?o.resolve(this):o.try(function(){return n.key.toPublic()}).then(function(t){return n.utils.getKeyBlueprint(t).then(function(r){return new e(n.utils,t,r)})})},e.prototype.unlock=function(n,t){var r=this;return this.bp.isLocked?o.try(function(){var t=r.utils.cloneKey(r.key);return t.decrypt(n).then(function(n){return n?e.getInstance(r.utils,t):o.reject(new Error("fail to unlock key"))})}):o.reject(new Error("key not locked"))},e.prototype.lock=function(n,t){var r=this;return this.bp.isLocked?o.reject(new Error("key not unlocked")):o.try(function(){return r.key.encrypt(n).then(function(n){return e.getInstance(r.utils,n)})}).finally(function(){return delete r.key})},e.prototype.sign=function(e,t){var r=this;return"production"!==n.env.NODE_ENV&&console.log("WARNING: opgp-service/live-key#sign method is not tested."),o.try(function(){return r.utils.openpgp.message.fromText(e).sign([r.key]).then(function(e){return e.armor()})})},e.prototype.verify=function(e,t){var r=this;return"production"!==n.env.NODE_ENV&&console.log("WARNING: opgp-service/live-key#verify method is not tested."),o.try(function(){var n=r.utils.openpgp.message.readArmored(e);return n.verify([r.key]).then(function(e){return e.length&&e[0].valid?n.getText():o.reject(new Error("authentication failed"))})})},e.getInstance=function(n,t,r){return n.getKeyBlueprint(t).then(function(r){return new e(n,t,r)})},e.getFactory=function(n){var t=new c(n.openpgp);return e.getInstance.bind(e,t)},e}(),c=function(){function e(e){this.openpgp=e}return e.prototype.getKeyBlueprint=function(e){var n=this,t=this._getPrimaryOpgpKeyId(e),r=o.all(e.subKeys.map(function(t){return n._getSubkeyOpgpKeyId(e,t)}));return o.all([t,r]).then(function(n){var t=n[0],r=n[1];return{isLocked:function(e){return!e.primaryKey.isDecrypted()}(e),isPublic:e.isPublic(),keys:[t].concat(r),user:{ids:e.getUserIds()}}})},e.prototype.getHashes=function(e){return{hash:this.getFingerprintHash(e),fingerprint:e.getFingerprint()}},e.prototype.getPrimaryKeyType=function(e){var n=this.cloneKey(e);return n.subKeys=[],{isAuth:!!n.getSigningKey(),isCiph:!!n.getEncryptionKey()}},e.prototype.getFingerprintHash=function(e,n){var t=e.writeOld(),r=this.openpgp.crypto.hash[n&&n.hash||"sha256"](t);return i.fromByteArray(r)},e.prototype.cloneKey=function(e){return this.openpgp.key.readArmored(e.armor()).keys[0]},e.prototype._getPrimaryOpgpKeyId=function(e){var n=this,t=e.getExpirationTime().then(function(e){return e.valueOf()}),i=e.verifyPrimaryKey();return o.all([t,i]).then(function(t){var i=t[0],o=t[1];return r({},n.getHashes(e.primaryKey),n.getPrimaryKeyType(e),{status:o,expires:i.valueOf()})})},e.prototype._getSubkeyOpgpKeyId=function(e,n){var t=this;return n.verify(e.primaryKey).then(function(i){return r({},t.getHashes(n.keyPacket),{isCiph:!!e.getEncryptionKey(n.getKeyId()),isAuth:!!e.getSigningKey(n.getKeyId()),status:i,expires:n.getExpirationTime().valueOf()})})},e}();var a=u.getFactory;t.default=a}).call(this,e(1))},{1:1,undefined:void 0}]},{},[3]);